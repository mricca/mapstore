<!--  MSMButtons.html    Tests the workings of the Buttons of Map Store Manager --><html>    <head>                <!-- All css -->        <link rel="stylesheet" type="text/css" href="../../lib/ext/resources/css/ext-all.css" />        <link rel="stylesheet" type="text/css" href="../../theme/css/mapstoremanager.css" />        <!--link rel="stylesheet" type="text/css" href="../../theme/css/grid-examples.css" /-->        <!-- ExtJS scripts -->        <script type="text/javascript" src="../../lib/ext/adapter/ext/ext-base.js"></script>        <script type="text/javascript" src="../../lib/ext/ext-all-debug.js"></script>                <!-- GeoExt scripts -->        <script type="text/javascript" src="../../lib/Lang.js"></script>                <!-- Ext ux scripts -->        <script type="text/javascript" src="../../lib/ext/ux/RowExpander.js"></script>        <!-- auth base64 scripts -->        <script type="text/javascript" src="../../lib/auth/base64.js"></script>        <!-- MapStoreManager scripts -->        <script type="text/javascript" src="config.js"></script>        <script type="text/javascript" src="../../src/MSMLogin.js"></script>        <script type="text/javascript" src="../../src/MSMGridPanel.js"></script>        <script type="text/javascript" src="../../src/MSMIframe.js"></script>        <script type="text/javascript" src="../../src/MSMPagingToolbar.js"></script>                <!-- tests settings  -->        <script type="text/javascript" src="settings.js"></script>                <!-- translation data  -->        <script type="text/javascript" src="../../translations/it.js"></script>        <script type="text/javascript" src="../../translations/en.js"></script>        <script type="text/javascript">                //Counts the resources of geostore before the tests        var initTotalCount;                     //Counts the resources of geostore before the tests        function test_initTotalCount(t) {            t.plan(1);            t.delay_call(5, function () {                initTotalCount = grid.store.getTotalCount();                if (initTotalCount || initTotalCount!=0){                    t.eq(true, true, "initTotalCount = " + initTotalCount);                }else{                    t.eq(false, false, "initTotalCount = " + initTotalCount);                }            });        }                //Test newMapButton        function test_newMapButtons(t) {            t.plan(1);            newMapButtonExecute();            t.delay_call(10, function () {                if (document.getElementById('mapiframe') && document.getElementById('mapiframe').contentWindow.app){                    t.ok(true, "The new map opens properly");                }else{                    t.fail("The new map does't open properly");                }            });        }                //Test close newMapButton        function test_newMapButtonsClose(t) {            t.plan(1);            newMapButtonCloseExecute();            t.delay_call(10, function () {                if (document.getElementById('mapiframe') == null){                    t.ok(true, "The new map is closed properly");                }else{                    t.fail("The new map does't closed properly");                }            });        }                //Test expandAll button        function test_expandAllButton(t) {            t.plan(initTotalCount);            expandAllExecute();            t.delay_call(5, function () {                var i = 0;                for (i=0; i<initTotalCount; i++) {                    var row = grid.view.getRow(i);                    var record = grid.store.getAt(row.rowIndex);                    var rowState = grid.plugins.state[record.id];                    t.eq(rowState, true, "the row with resource id " + record.data.id + " and Name " + record.data.name + " is expanded");                }            });        }        //Test collapseAll button        function test_collapseAllButton(t) {            t.plan(initTotalCount);            collapseAllExecute();            t.delay_call(5, function () {                var i = 0;                for (i=0; i<initTotalCount; i++) {                    var row = grid.view.getRow(i);                    var record = grid.store.getAt(row.rowIndex);                    var rowState = grid.plugins.state[record.id];                    t.eq(rowState, false, "the row with resource id " + record.data.id + " and Name " + record.data.name + " is collapsed");                }            });        }        //Test Open MapComposer in view mode        function test_ViewMapButton(t) {            t.plan(1);            var i = 0;            var row = grid.view.getRow(0);            var record = grid.store.getAt(row.rowIndex);            var rowState = grid.plugins.state[record.id];            document.getElementById('ext-gen89_viewBtn').click(function(e) {                    var idMap = record.data.id;                    var desc = record.data.name;                    var userProfile = '&auth=false&fullScreen=true';                    grid.plugins.openMapComposer(config.mcUrl,userProfile,idMap,desc);                }            );            t.delay_call(15, function () {                if (document.getElementById('mapiframe') && document.getElementById('mapiframe').contentWindow.app){                    t.ok(true, "The new map for view opens properly");                }else{                    t.fail("The new map for view does't open properly");                }            });        }        //Test Open MapComposer in edit mode        function test_EditMapButton(t) {            t.plan(1);            var i = 0;            var row = grid.view.getRow(0);            var record = grid.store.getAt(row.rowIndex);            var rowState = grid.plugins.state[record.id];            document.getElementById('ext-gen90_editBtn').click(function(e){                    var idMap = record.data.id;                    var desc = record.data.name;                    var userProfile = '&auth=true';                    grid.plugins.openMapComposer(config.mcUrl,userProfile,idMap,desc);                }            );            t.delay_call(15, function () {                if (document.getElementById('mapiframe') && document.getElementById('mapiframe').contentWindow.app){                    t.ok(true, "The new map for edit opens properly");                }else{                    t.fail("The new map for edit does't open properly");                }            });        }                //Delete test        function test_deleteMapButton(t) {            deleteMapButton(t);              }                </script>    </head>    <body>        <!--a href="http://www.geo-solutions.it/" target="_blank" title="GeoSolutions Home page"><div class="geosolutions_logo" align="center"></div></a-->        <div id="topic-grid" align="center"></div>    </body></html>