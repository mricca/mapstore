<!--  MSMSearchTool.html    Tests the workings of the searh tool of Map Store Manager --><html>    <head>                <!-- All css -->        <link rel="stylesheet" type="text/css" href="../../lib/ext/resources/css/ext-all.css" />        <link rel="stylesheet" type="text/css" href="../../theme/css/mapstoremanager.css" />        <!--link rel="stylesheet" type="text/css" href="../../theme/css/grid-examples.css" /-->        <!-- ExtJS scripts -->        <script type="text/javascript" src="../../lib/ext/adapter/ext/ext-base.js"></script>        <script type="text/javascript" src="../../lib/ext/ext-all-debug.js"></script>                <!-- GeoExt scripts -->        <script type="text/javascript" src="../../lib/Lang.js"></script>                <!-- Ext ux scripts -->        <script type="text/javascript" src="../../lib/ext/ux/RowExpander.js"></script>        <!-- auth base64 scripts -->        <script type="text/javascript" src="../../lib/auth/base64.js"></script>        <!-- MapStoreManager scripts -->        <script type="text/javascript" src="config.js"></script>        <script type="text/javascript" src="../../src/MSMGridPanel.js"></script>        <script type="text/javascript" src="../../src/MSMIframe.js"></script>        <script type="text/javascript" src="../../src/MSMPagingToolbar.js"></script>                <!-- tests settings  -->        <script type="text/javascript" src="settings.js"></script>                <!-- translation data  -->        <script type="text/javascript" src="../../translations/it.js"></script>        <script type="text/javascript" src="../../translations/en.js"></script>        <script type="text/javascript">        //Counts the resources of geostore before the tests        var initTotalCount;        //Counts the resources of geostore after the tests        var finalTotalCount;                function test_init1(t) {            t.plan(1);            t.wait_result(5);            t.ok(true, "panel initialized");        }                //Counts the resources of geostore before the tests        function test_initTotalCount(t) {            t.plan(1);            t.delay_call(5, function () {                grid.getBottomToolbar().bindStore(grid.store, true);                grid.getBottomToolbar().doRefresh();                initTotalCount = grid.store.getTotalCount();                if (initTotalCount || initTotalCount!=0){                    t.eq(true, true, "initTotalCount = " + initTotalCount);                }else{                    t.eq(false, false, "initTotalCount = " + initTotalCount);                }            });        }                //Add resources to geostore for tests        function test_addResource(t) {            addResource(t);        }                //Counts the resources of geostore after the tests        function test_finalTotalCount(t) {            t.plan(1);            t.delay_call(5, function () {                grid.getBottomToolbar().bindStore(grid.store, true);                grid.getBottomToolbar().doRefresh();                finalTotalCount = grid.store.getTotalCount();                if (finalTotalCount || finalTotalCount!=0){                    t.eq(true, true, "finalTotalCount = " + finalTotalCount);                }else{                    t.eq(false, false, "finalTotalCount = " + finalTotalCount);                }            });        }                //Search with star value        function test_searchFreeText1(t) {            //setupTest();            t.plan(1);            grid.inputSearch.setValue("*");            searchExecute();            t.delay_call(5, function () {                t.eq(finalTotalCount-initTotalCount, 3, "Correctly populated grid with records from a free text search '*'");            });        }                //Search with blank value        function test_searchFreeText2(t) {            //setupTest();            t.plan(1);            grid.inputSearch.setValue("");            searchExecute();            t.delay_call(5, function () {                t.eq(finalTotalCount-initTotalCount, 3, "Correctly populated grid with records from an empty text");            });        }        //Search with '(Buffer Zone)' value        function test_searchFreeText3(t) {            //setupTest();            t.plan(1);            grid.inputSearch.setValue("(Buffer Zone)");            searchExecute();            t.delay_call(5, function () {                t.eq(grid.store.getTotalCount(), 1, "Correctly populated grid with records from a free text search (Buffer Zone)");            });        }                //Search with 'Fires' value        function test_searchFreeText4(t) {            //setupTest();            t.plan(1);            grid.inputSearch.setValue("Fires");            searchExecute();            t.delay_call(5, function () {                t.eq(grid.store.getTotalCount(), 1, "Correctly populated grid with records from a free text search Fires");            });        }                //Search with 'FiReS' value        function test_searchFreeText5(t) {            //setupTest();            t.plan(1);            grid.inputSearch.setValue("FiReS");            searchExecute();            t.delay_call(5, function () {                t.eq(grid.store.getTotalCount(), 1, "Correctly populated grid with records from a free text search FiReS");            });        }                //Search with '    FiReS     ' value        function test_searchFreeText6(t) {            //setupTest();            t.plan(1);            grid.inputSearch.setValue("    FiReS     ");            searchExecute();            t.delay_call(5, function () {                t.eq(grid.store.getTotalCount(), 1, "Correctly populated grid with records from a free text search    FiReS     ");            });        }                //Search with '   Climatology    (' value        function test_searchFreeText7(t) {            //setupTest();            t.plan(1);            grid.inputSearch.setValue("   Climatology    (");            searchExecute();            t.delay_call(5, function () {                t.eq(grid.store.getTotalCount(), 1, "Correctly populated grid with records from a free text search    Climatology    (");            });        }                //Search with '   Climatology    (' value        function test_searchFreeText8(t) {            //setupTest();            t.plan(1);            grid.inputSearch.setValue("123");            searchExecute();            t.delay_call(5, function () {                t.eq(grid.errorMsg_500, "The server returns HTTP status code 500! </br></br>Check the log!", "Correctly populated grid with records from a free text search");            });        }                //This test must fail because the search string doesn't match any resources of geostore        function test_searchFreeText9(t) {            //setupTest();            t.plan(1);            grid.inputSearch.setValue("123");            searchExecute();            t.delay_call(5, function () {                t.fail("No string found, The server returns HTTP status code 500! </br></br>Check the log!", "Correctly populated grid with records from a free text search");            });        }        //Reset test        function test_resetSearchTool(t) {            //setupTest();            t.plan(1);            resetExecute();            t.delay_call(5, function () {                t.eq(finalTotalCount-initTotalCount, 3, "Correctly reset SearchTool");            });        }        //Delete test        function test_delResources(t) {            delResource(t);        }                </script>    </head>    <body>        <!--a href="http://www.geo-solutions.it/" target="_blank" title="GeoSolutions Home page"><div class="geosolutions_logo" align="center"></div></a-->        <div id="topic-grid" align="center"></div>    </body></html>